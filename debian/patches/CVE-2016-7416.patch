From 92db16e456ed346d0526c840750213317ac0f067 Mon Sep 17 00:00:00 2001
From: Stanislav Malyshev <stas@php.net>
Date: Mon, 5 Sep 2016 18:01:35 -0700
Subject: [PATCH] Fix bug #73007: add locale length check

(cherry picked from commit 9e07089626f373d0e7b24b7aeb8b8459aae5f5f8)

Conflicts:
	ext/intl/msgformat/msgformat_format.c
---
 ext/intl/msgformat/msgformat_format.c | 2 ++
 1 file changed, 2 insertions(+)

Index: php7.0-7.0.8/ext/intl/msgformat/msgformat_format.c
===================================================================
--- php7.0-7.0.8.orig/ext/intl/msgformat/msgformat_format.c	2016-10-03 13:01:31.957271059 -0400
+++ php7.0-7.0.8/ext/intl/msgformat/msgformat_format.c	2016-10-03 13:01:31.953271014 -0400
@@ -117,6 +117,8 @@
 		RETURN_FALSE;
 	}
 
+	INTL_CHECK_LOCALE_LEN(slocale_len);
+
 	memset(mfo, 0, sizeof(*mfo));
 	msgformat_data_init(&mfo->mf_data);
 
