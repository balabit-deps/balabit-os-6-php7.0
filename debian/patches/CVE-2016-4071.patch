Backport of:

From 9c19a08b9daed6bae3071dd25742f59a59618823 Mon Sep 17 00:00:00 2001
From: Anatol Belski <ab@php.net>
Date: Wed, 16 Mar 2016 09:48:40 +0100
Subject: [PATCH] Fixed bug #71704 php_snmp_error() Format String Vulnerability

Conflicts:
	ext/snmp/snmp.c
---
 ext/snmp/snmp.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: php7.0-7.0.4/ext/snmp/snmp.c
===================================================================
--- php7.0-7.0.4.orig/ext/snmp/snmp.c	2016-05-17 13:02:02.298536386 -0400
+++ php7.0-7.0.4/ext/snmp/snmp.c	2016-05-17 13:02:59.055263553 -0400
@@ -530,7 +530,7 @@
 	}
 
 	if (object && (snmp_object->exceptions_enabled & type)) {
-		zend_throw_exception_ex(php_snmp_exception_ce, type, snmp_object->snmp_errstr);
+		zend_throw_exception_ex(php_snmp_exception_ce, type, "%s", snmp_object->snmp_errstr);
 	} else {
 		va_start(args, format);
 		php_verror(docref, "", E_WARNING, format, args);
